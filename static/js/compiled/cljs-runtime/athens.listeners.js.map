{"version":3,"sources":["athens/listeners.cljs"],"mappings":"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","names":["athens.listeners/multi-block-selection","e","cljs.core/deref","selected-items","re_frame.core.subscribe","cljs.core/not-empty","shift","key-code","enter?","cljs.core._EQ_","goog.events.KeyCodes/ENTER","bksp?","goog.events.KeyCodes/BACKSPACE","up?","goog.events.KeyCodes/UP","down?","goog.events.KeyCodes/DOWN","tab?","goog.events.KeyCodes/TAB","delete?","goog.events.KeyCodes/DELETE","re-frame.core/dispatch","cljs.core/first","and__4115__auto__","cljs.core/last","athens.listeners/unfocus","selected-items?","editing-uid","closest-block","closest-block-header","closest-page-header","closest-bullet","closest-dropdown","closest","or__4126__auto__","athens.listeners/key-down","map__95412","cljs.core/PROTOCOL_SENTINEL","cljs.core.apply","cljs.core/hash-map","cljs.core.get","ctrl","meta","alt","athens.util/destruct-key-down","athens.util/shortcut-key?","pred__95418","expr__95419","cljs.core/=","goog.events.KeyCodes/S","goog.events.KeyCodes/K","goog.events.KeyCodes/G","goog.events.KeyCodes/Z","goog.events.KeyCodes/BACKSLASH","goog.events.KeyCodes/T","athens.util/toggle-10x","pred__95423","expr__95424","goog.events.KeyCodes/LEFT","js/window.history","goog.events.KeyCodes/RIGHT","goog.events.KeyCodes/D","athens.router/nav-daily-notes","athens.listeners/unformat-double-brackets","s","clojure.string/replace","athens.listeners/block-refs-to-plain-text","replacements","cljs.core/re-seq","cljs.core.map","p__95436","vec__95437","cljs.core.nth","orig-str","match-str","eid","athens.db/e-by-av","athens.db/v-by-ea","replace-str","cljs.core/second","cljs.core/empty?","cljs.core/rest","var_args","G__95463","athens.listeners/blocks-to-clipboard-data","js/Error","depth","node","athens.listeners.blocks_to_clipboard_data","unformat?","map__95466","string","children","header","left-offset","cljs.core/str","cljs.core.repeat","walk-children","p1__95461#","header-to-str","G__95476","dash","athens.listeners/copy","uids","copy-data","p1__95477#","athens.db/get-block-document","p1__95478#","athens.listeners/cut","p1__95480#","p1__95481#","athens.listeners/prevent-save","js/window.addEventListener","goog.events.EventType/BEFOREUNLOAD","synced?","athens.listeners/init","goog.events/listen","js/document","goog.events.EventType/MOUSEDOWN","js/window","goog.events.EventType/KEYDOWN","goog.events.EventType/COPY","goog.events.EventType/CUT"],"sourcesContent":["(ns athens.listeners\n  (:require\n    [athens.db :as db]\n    [athens.router :as router]\n    [athens.util :as util]\n    [cljsjs.react]\n    [cljsjs.react.dom]\n    [clojure.string :as string]\n    [goog.events :as events]\n    [re-frame.core :refer [dispatch subscribe]])\n  (:import\n    (goog.events\n      EventType\n      KeyCodes)))\n\n\n(defn multi-block-selection\n  \"When blocks are selected, handle various keypresses:\n  - shift+up/down: increase/decrease selection.\n  - enter: deselect and begin editing textarea\n  - backspace: delete all blocks\n  - up/down: change editing textarea\n  - tab: indent/unindent blocks\n  Can't use textarea-key-down from keybindings.cljs because textarea is no longer focused.\"\n  [e]\n  (let [selected-items @(subscribe [:selected/items])]\n    (when (not-empty selected-items)\n      (let [shift    (.. e -shiftKey)\n            key-code (.. e -keyCode)\n            enter?   (= key-code KeyCodes.ENTER)\n            bksp?    (= key-code KeyCodes.BACKSPACE)\n            up?      (= key-code KeyCodes.UP)\n            down?    (= key-code KeyCodes.DOWN)\n            tab?     (= key-code KeyCodes.TAB)\n            delete?  (= key-code KeyCodes.DELETE)]\n        (cond\n          enter? (do\n                   (dispatch [:editing/uid (first selected-items)])\n                   (dispatch [:selected/clear-items]))\n          (or bksp? delete?) (dispatch [:selected/delete selected-items])\n          tab? (do\n                 (.preventDefault e)\n                 (if shift\n                   (dispatch [:unindent/multi selected-items])\n                   (dispatch [:indent/multi selected-items])))\n          (and shift up?) (dispatch [:selected/up selected-items])\n          (and shift down?) (dispatch [:selected/down selected-items])\n          (or up? down?) (do\n                           (.preventDefault e)\n                           (dispatch [:selected/clear-items])\n                           (if up?\n                             (dispatch [:up (first selected-items) e])\n                             (dispatch [:down (last selected-items) e]))))))))\n\n\n(defn unfocus\n  \"Clears editing/uid when user clicks anywhere besides bullets, header, or on a block.\n  Clears selected/items when user clicks somewhere besides a bullet point.\"\n  [e]\n  (let [selected-items?      (not-empty @(subscribe [:selected/items]))\n        editing-uid          @(subscribe [:editing/uid])\n        closest-block        (.. e -target (closest \".block-content\"))\n        closest-block-header (.. e -target (closest \".block-header\"))\n        closest-page-header  (.. e -target (closest \".page-header\"))\n        closest-bullet       (.. e -target (closest \".bullet\"))\n        closest-dropdown     (.. e -target (closest \"#dropdown-menu\"))\n        closest              (or closest-block closest-block-header closest-page-header closest-dropdown)]\n    (when (and selected-items?\n               (nil? closest-bullet))\n      (dispatch [:selected/clear-items]))\n    (when (and (nil? closest)\n               editing-uid)\n      (dispatch [:editing/uid nil]))))\n\n\n;; -- Hotkeys ------------------------------------------------------------\n\n\n(defn key-down\n  [e]\n  (let [{:keys [key-code ctrl meta shift alt]} (util/destruct-key-down e)\n        editing-uid @(subscribe [:editing/uid])]\n    (cond\n      (util/shortcut-key? meta ctrl) (condp = key-code\n                                       KeyCodes.S (dispatch [:save])\n\n                                       KeyCodes.K (dispatch [:athena/toggle])\n\n                                       KeyCodes.G (dispatch [:devtool/toggle])\n\n                                       KeyCodes.Z (let [editing-uid    @(subscribe [:editing/uid])\n                                                        selected-items @(subscribe [:selected/items])]\n                                                    ;; editing/uid must be nil or selected-items must be non-empty\n                                                    (when (or (nil? editing-uid)\n                                                              (not-empty selected-items))\n                                                      (if shift\n                                                        (dispatch [:redo])\n                                                        (dispatch [:undo]))))\n\n                                       KeyCodes.BACKSLASH (if shift\n                                                            (dispatch [:right-sidebar/toggle])\n                                                            (dispatch [:left-sidebar/toggle]))\n                                       KeyCodes.T (util/toggle-10x)\n                                       nil)\n      alt (condp = key-code\n            KeyCodes.LEFT (when (nil? editing-uid) (.back js/window.history))\n            KeyCodes.RIGHT (when (nil? editing-uid) (.forward js/window.history))\n            KeyCodes.D (router/nav-daily-notes)\n            nil))))\n\n\n;; -- Clipboard ----------------------------------------------------------\n\n(defn unformat-double-brackets\n  \"https://github.com/ryanguill/roam-tools/blob/eda72040622555b52e40f7a28a14744bce0496e5/src/index.js#L336-L345\"\n  [s]\n  (-> s\n      (string/replace #\"\\[([^\\[\\]]+)\\]\\((\\[\\[|\\(\\()([^\\[\\]]+)(\\]\\]|\\)\\))\\)\" \"$1\")\n      (string/replace #\"\\[\\[([^\\[\\]]+)\\]\\]\" \"$1\")))\n\n\n(defn block-refs-to-plain-text\n  \"If there is a valid ((uid)), find the original block's string.\n  If invalid ((uid)), no-op.\n  TODO: If deep block ref, convert deep block ref to plain-text.\n\n  Want to put this in athens.util, but circular dependency from athens.db\"\n  [s]\n  (let [replacements (->> s\n                          (re-seq #\"\\(\\(([^\\(\\)]+)\\)\\)\")\n                          (map (fn [[orig-str match-str]]\n                                 (let [eid (db/e-by-av :block/uid match-str)]\n                                   (if eid\n                                     [orig-str (db/v-by-ea eid :block/string)]\n                                     [orig-str (str \"((\" match-str \"))\")])))))]\n    (loop [replacements replacements\n           s            s]\n      (let [orig-str    (first (first replacements))\n            replace-str (second (first replacements))]\n        (if (empty? replacements)\n          s\n          (recur (rest replacements)\n                 (clojure.string/replace s orig-str replace-str)))))))\n\n\n(defn blocks-to-clipboard-data\n  \"Four spaces per depth level.\"\n  ([depth node]\n   (blocks-to-clipboard-data depth node false))\n  ([depth node unformat?]\n   (let [{:block/keys [string children header]} node\n         left-offset   (apply str (repeat depth \"    \"))\n         walk-children (apply str (map #(blocks-to-clipboard-data (inc depth) % unformat?) children))\n         string (let [header-to-str (case header\n                                      1 \"# \"\n                                      2 \"## \"\n                                      3 \"### \"\n                                      \"\")]\n                  (str header-to-str string))\n         string (if unformat?\n                  (-> string unformat-double-brackets athens.listeners/block-refs-to-plain-text)\n                  string)\n         dash (if unformat? \"\" \"- \")]\n     (str left-offset dash string \"\\n\" walk-children))))\n\n\n(defn copy\n  \"If blocks are selected, copy blocks as markdown list.\n  Use -event_ because goog events quirk \"\n  [^js e]\n  (let [uids @(subscribe [:selected/items])]\n    (when (not-empty uids)\n      (let [copy-data (->> (map #(db/get-block-document [:block/uid %]) uids)\n                           (map #(blocks-to-clipboard-data 0 %))\n                           (apply str))]\n        (.. e preventDefault)\n        (.. e -event_ -clipboardData (setData \"text/plain\" copy-data))))))\n\n\n(defn cut\n  \"Cut is essentially copy AND delete selected blocks\"\n  [^js e]\n  (let [uids @(subscribe [:selected/items])]\n    (when (not-empty uids)\n      (let [copy-data (->> (map #(db/get-block-document [:block/uid %]) uids)\n                           (map #(blocks-to-clipboard-data 0 %))\n                           (apply str))]\n        (.. e preventDefault)\n        (.. e -event_ -clipboardData (setData \"text/plain\" copy-data))\n        (dispatch [:selected/delete uids])))))\n\n\n(defn prevent-save\n  \"Google Closure's events/listen isn't working for some reason anymore.\n\n  beforeunload is called before unload, where the window would be redirected/refreshed/quit.\n  https://developer.mozilla.org/en-US/docs/Web/API/Window/beforeunload_event \"\n  []\n  (js/window.addEventListener\n    EventType.BEFOREUNLOAD\n    (fn [e]\n      (let [synced? @(subscribe [:db/synced])]\n        (when-not synced?\n          (dispatch [:alert/js \"Athens hasn't finished saving yet. Athens is finished saving when the sync dot is green. Try refreshing or quitting again once the sync is complete.\"])\n          (.. e preventDefault)\n          (set! (.. e -returnValue) \"Setting e.returnValue to string prevents exit for some browsers.\")\n          \"Returning a string also prevents exit on other browsers.\")))))\n\n\n(defn init\n  []\n  (events/listen js/document EventType.MOUSEDOWN unfocus)\n  (events/listen js/window EventType.KEYDOWN multi-block-selection)\n  (events/listen js/window EventType.KEYDOWN key-down)\n  (events/listen js/window EventType.COPY copy)\n  (events/listen js/window EventType.CUT cut)\n  (prevent-save))\n"]}